% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MultiGeneFeatureDotPlot.R
\name{MultiGeneFeatureDotPlot}
\alias{MultiGeneFeatureDotPlot}
\title{Multi-gene UMAP(s) + DotPlot composite for Seurat objects}
\usage{
MultiGeneFeatureDotPlot(
  object,
  reduction = "umap",
  genes = NULL,
  na.cutoff = 0.5,
  max.expression = NULL,
  scale.legend = FALSE,
  scale.legend.max = FALSE,
  pt.size = 0.5,
  alpha = 0.5,
  group.by = NULL,
  label = TRUE,
  repel = FALSE,
  gene.ref.table = NULL,
  gene.ref.col = "mzebra_seurat_gene_id",
  new.name.col = "human_homolog",
  secondary.ref.col = "mzebra_to_human_true_homolog",
  convert.names = FALSE,
  assay = Seurat::DefaultAssay(object),
  legend.ncols = NULL,
  plot.title = NULL,
  plot.subtitle = NULL,
  split.by = NULL,
  split.umaps = FALSE,
  umap.ncols = 2
)
}
\arguments{
\item{object}{Seurat object.}

\item{reduction}{Character. Embedding to use (e.g., \code{"umap"}, \code{"umap.wnn"}).}

\item{genes}{Character vector of genes (mzebra or human; mixed allowed).}

\item{na.cutoff}{Numeric. Values ≤ this are treated as “off” for plotting.}

\item{max.expression}{Optional numeric upper cap for color scales.}

\item{scale.legend}{Logical. If \code{TRUE}, force all genes to share the same
color limits; otherwise scale per gene.}

\item{scale.legend.max}{Logical. With \code{scale.legend=TRUE}, use the max of
per-gene 95th percentiles instead of min of 99th percentiles.}

\item{pt.size}{Numeric point size for UMAP.}

\item{alpha}{Numeric point alpha for UMAP.}

\item{group.by}{Column name in \code{object@meta.data} (or vector/factor) used
for cluster labels and DotPlot grouping. If \code{NULL}, defaults to \code{Idents}.}

\item{label}{Logical. Draw cluster labels on UMAP(s).}

\item{repel}{Logical. Use ggrepel for labels (if available).}

\item{gene.ref.table}{Optional data.frame for homolog mapping.}

\item{gene.ref.col}{Column in \code{gene.ref.table} with mzebra IDs (default).}

\item{new.name.col}{Column with human homolog names.}

\item{secondary.ref.col}{Logical column indicating true homolog rows.}

\item{convert.names}{Logical. If \code{TRUE}, show human homologs in legends/x-axis.}

\item{assay}{Assay to use. Defaults to \code{Seurat::DefaultAssay(object)}.}

\item{legend.ncols}{Optional integer. If set (and \code{split.umaps=FALSE}),
renders a separate multi-column legend panel next to the UMAP.}

\item{plot.title, plot.subtitle}{Optional title/subtitle for UMAP.}

\item{split.by}{Optional column name for DotPlot splitting.}

\item{split.umaps}{Logical. If \code{TRUE}, draw one UMAP per gene.}

\item{umap.ncols}{Integer. Number of columns for the per-gene UMAP grid.}
}
\value{
A patchwork object combining UMAP (single or grid) and a DotPlot.
}
\description{
Builds either (a) a single composite UMAP with multi-gene color overlays
or (b) a grid of one UMAP per gene (controlled by \code{split.umaps}), and
appends a DotPlot summarizing expression across groups. Gene names can be
matched to assay features directly or via a homolog mapping table.
}
\examples{
\dontrun{
MultiGeneFeatureDotPlot(
  object = seurat_obj,
  reduction = "umap.wnn",
  genes = c("fat2","LOC101479120","cga","fabp7","myrf","pitx2"),
  gene.ref.table = homologs, convert.names = TRUE,
  label = TRUE, repel = TRUE,
  split.umaps = TRUE, umap.ncols = 3
)
}
}
